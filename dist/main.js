!function(r){var e={};function o(t){if(e[t])return e[t].exports;var n=e[t]={i:t,l:!1,exports:{}};return r[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=r,o.c=e,o.d=function(t,n,r){o.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(n,t){if(1&t&&(n=o(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var e in n)o.d(r,e,function(t){return n[t]}.bind(null,e));return r},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.p="",o(o.s=0)}([function(t,n,r){"use strict";function o(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(!t)return;if("string"==typeof t)return a(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,n)}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}r.r(n);function i(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(!t)return;if("string"==typeof t)return u(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,n)}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function u(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}new Vue({el:"#app",components:{cart:{data:function(){return{cartUrl:"/getCart.json",cartItems:[],showCart:!1}},components:{cartItem:{props:["img","cartItem"],template:'<div class="cart-item">\n\t\t\t\t\t\t\t\t<div class="product-block">\n\t\t\t\t\t\t\t\t\t\t<img :src="img" alt="Some img">\n\t\t\t\t\t\t\t\t\t\t<div class="product-desc">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="product-title">{{ cartItem.product_name }}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="product-quantity">Кол-во: {{ cartItem.quantity }}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="product-single-price">$ {{ cartItem.product_price }}</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="price-block">\n\t\t\t\t\t\t\t\t\t\t<div class="product-price">{{cartItem.quantity*cartItem.product_price}} $</div>\n\t\t\t\t\t\t\t\t\t\t<i class="fas fa-trash" @click="$emit(\'remove\', cartItem)"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>'}},mounted:function(){var e=this;this.$parent.getJson("/api/cart").then(function(t){var n=o(t.contents);try{for(n.s();!(r=n.n()).done;){var r=r.value;e.$data.cartItems.push(r)}}catch(t){n.e(t)}finally{n.f()}})},methods:{addProduct:function(n){var r,e=this,o=this.cartItems.find(function(t){return t.id_product===n.id_product});o?this.$parent.putJson("/api/cart/".concat(o.id_product),{quantity:1}).then(function(t){1===t.result&&o.quantity++}):(r=Object.assign({quantity:1},n),this.$parent.postJson("/api/cart",r).then(function(t){1===t.result&&e.cartItems.push(r)}))},remove:function(n){var r=this;1<n.quantity?this.$parent.putJson("/api/cart/".concat(n.id_product),{quantity:-1}).then(function(t){1===t.result&&n.quantity--}):this.$parent.deleteJson("/api/cart/".concat(n.id_product)).then(function(t){1===t.result&&r.cartItems.splice(r.cartItems.indexOf(n),1)})}},template:'<div>\n\t\t\t\t\t\t\t\t<button @click="showCart=!showCart" class="btn-cart" type="button"><i class="fas fa-shopping-cart"></i></button>\n\t\t\t\t\t\t\t\t<div class="cart-block" v-show="showCart">\n\t\t\t\t\t\t\t\t\t<cart-item v-for="item of cartItems" :key="item.id_product" :img="item.image" :cart-item="item" @remove="remove">\n\t\t\t\t\t\t\t\t\t</cart-item>\n\t\t\t\t\t\t\t\t\t<p class="cart-empty" v-if="!cartItems.length">Ваша корзина пуста</p>\n\t\t\t\t\t\t\t\t\t<button class="buy-btn cart-button" v-else="cartItems.length">Заказать</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>'},products:{data:function(){return{catalogUrl:"/catalogData.json",products:[],filterProducts:[]}},components:{product:{props:["product","img"],template:'<div class="product-item">\n\t\t\t\t\t\t\t\t<img :src="img" alt="photo product">\n\t\t\t\t\t\t\t\t<h3>{{ product.product_name }}</h3>\n\t\t\t\t\t\t\t\t<p>{{ product.product_desc }}</p>\n\t\t\t\t\t\t\t\t<p>{{ product.product_price }}&#36;</p>\n\t\t\t\t\t\t\t\t<button class="buy-btn" @click="$emit(\'add-product\', product)">Купить</button>\n\t\t\t\t\t\t\t</div>'}},methods:{filtered:function(t){var n=new RegExp(t,"i");this.filterProducts=this.products.filter(function(t){return n.test(t.product_name)})}},mounted:function(){var e=this;this.$parent.getJson("/api/products").then(function(t){var n=i(t);try{for(n.s();!(r=n.n()).done;){var r=r.value;e.$data.products.push(r),e.$data.filterProducts.push(r)}}catch(t){n.e(t)}finally{n.f()}})},template:'<div class="products">\n\t\t\t\t\t\t\t\t<product v-for="item of filterProducts" \n\t\t\t\t\t\t\t\t:key="item.id_product"\n\t\t\t\t\t\t\t\t:img="item.image"\n\t\t\t\t\t\t\t\t:product="item"\n\t\t\t\t\t\t\t\t@add-product="$parent.$refs.cart.addProduct"></product>\n\t\t\t\t\t\t\t</div>'},error:{data:function(){return{text:""}},computed:{isVisible:function(){return""!==this.text}},template:'\n\t<div class="error-block" v-if="isVisible">\n\t\t<p class="error-msg">\n\t\t\t<button class="close-btn" @click="text=\'\'">&times;</button>\n\t\t\t{{ text }}\n\t\t</p>\n\t</div>'},search:{data:function(){return{userSearch:""}},template:'<form action="#" class="search-form" @submit.prevent=\'$parent.$refs.products.filtered(userSearch)\'>\n\t\t\t\t\t<input type="text" class="search-field" v-model="userSearch">\n\t\t\t\t\t<button type="submit" class="btn-search">\n\t\t\t\t\t<svg class="search-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24">\n\t\t\t\t\t\t<path d="M23.762,22.681 L17.569,16.586 C19.190,14.825 20.187,12.494 20.187,9.929 C20.186,4.443 15.668,-0.002 10.093,-0.002 C4.519,-0.002 0.001,4.443 0.001,9.929 C0.001,15.416 4.519,19.862 10.093,19.862 C12.502,19.862 14.711,19.028 16.446,17.644 L22.663,23.763 C22.966,24.062 23.458,24.062 23.761,23.763 C24.065,23.464 24.065,22.979 23.762,22.681 ZM10.093,18.334 C5.377,18.334 1.553,14.572 1.553,9.929 C1.553,5.288 5.377,1.525 10.093,1.525 C14.810,1.525 18.633,5.288 18.633,9.929 C18.633,14.572 14.810,18.334 10.093,18.334 Z"></path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</form>'}},data:{userSearch:""},methods:{getJson:function(t){var n=this;return fetch(t).then(function(t){return t.json()}).catch(function(t){n.$refs.error.text=t})},postJson:function(t,n){var r=this;return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(t){return t.json()}).catch(function(t){r.$refs.error.text=t})},putJson:function(t,n){var r=this;return fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(t){return t.json()}).catch(function(t){r.$refs.error.text=t})},deleteJson:function(t){var n=this;return fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).catch(function(t){n.$refs.error.text=t})}}})}]);